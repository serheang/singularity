Bootstrap: library
From: ubuntu:18.04

%labels
  MAINTAINER setan
  WHATAMI visual studio code
  VERSION 2018.3

%environment
  CONTAINER="vs-code"
  export CONTAINER
  export PATH=/usr/local/bin:$PATH

%files
  code_1.36.1-1562627527_amd64.deb /root/

%post
  apt-get update -y
  apt install -y wget libasound2
  wget https://go.microsoft.com/fwlink/?LinkID=760868 -O /root/code.deb
  apt install -y -f /root/code.deb
  apt-get clean
  rm /root/code.deb

%runscript
  echo "You will need to BIND $XDG_RUNTIME_DIR when running VS Code."
  echo "$ singularity run -B $XDG_RUNTIME_DIR ${CONTAINER}.sif"
  echo "Trying to run Visual Studio Code"
  code
